<div class="radio-player" *ngIf="station">
  <div class="player-content">
    <!-- Station Icon -->
    <div class="station-icon">
      <img
        [src]="station.favicon || getPlaceholderImage()"
        [alt]="station.name"
        (error)="$any($event.target).src=getPlaceholderImage()"
      />
      <!-- Loading spinner overlay -->
      <div class="loading-overlay" *ngIf="isLoading">
        <div class="spinner"></div>
      </div>
    </div>

    <!-- Station Info -->
    <div class="station-info">
      <h3 class="station-name">{{ station.name }}</h3>

      <!-- Error message (compacto) -->
      <div class="error-badge" *ngIf="hasError">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
        </svg>
        <span>{{ errorMessage }}</span>
      </div>

      <!-- Loading message -->
      <div class="loading-badge" *ngIf="isLoading && !hasError">
        <div class="mini-spinner"></div>
        <span>Conectando...</span>
      </div>

      <!-- Normal info -->
      <div class="station-details" *ngIf="!hasError && !isLoading">
        <span class="detail-item">
          <!-- âœ… Globe icon en vez de ðŸŒ -->
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
          </svg>
          {{ getStationLocation() }}
        </span>
        <span class="detail-item" *ngIf="currentTime">
          <!-- âœ… Clock icon en vez de ðŸ• -->
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
          {{ currentTime }}
        </span>
        <span class="detail-item" *ngIf="station.language">
          <!-- âœ… Language/Message icon en vez de ðŸ—£ï¸ -->
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            <path d="M8 10h.01M12 10h.01M16 10h.01"/>
          </svg>
          {{ station.language }}
        </span>
      </div>

      <div class="station-meta">
        <span class="meta-tag" *ngIf="station.codec">{{ station.codec }}</span>
        <span class="meta-tag" *ngIf="station.bitrate">{{ station.bitrate }}kbps</span>
        <span class="meta-tag">
          <!-- âœ… Heart icon en vez de â¤ï¸ -->
          <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 2px; vertical-align: middle;">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
          </svg>
          {{ station.votes }}
        </span>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls">
      <button
        class="favorite-button"
        [class.active]="isFavorite"
        (click)="toggleFavorite()"
        [title]="isFavorite ? 'Quitar de favoritos' : 'Agregar a favoritos'"
      >
        <svg width="24" height="24" viewBox="0 0 24 24" [attr.fill]="isFavorite ? 'currentColor' : 'none'" stroke="currentColor" stroke-width="2">
          <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
        </svg>
      </button>

      <button class="random-button" (click)="requestRandom()" title="Radio aleatoria">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
          <path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
        </svg>
      </button>

      <button
        class="play-button"
        [class.loading]="isLoading"
        [class.error]="hasError"
        [class.playing]="isPlaying"
        (click)="togglePlay()"
        [disabled]="isLoading && !hasError"
        [title]="hasError ? 'Reintentar' : (isPlaying ? 'Pausar' : 'Reproducir')"
      >
        <!-- Loading spinner dentro del botÃ³n -->
        <div class="button-spinner" *ngIf="isLoading && !hasError"></div>

        <!-- Play icon -->
        <svg *ngIf="!isPlaying && !isLoading && !hasError" width="32" height="32" viewBox="0 0 24 24" fill="white">
          <path d="M8 5v14l11-7z"/>
        </svg>

        <!-- Pause icon -->
        <svg *ngIf="isPlaying && !isLoading && !hasError" width="32" height="32" viewBox="0 0 24 24" fill="white">
          <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
        </svg>

        <!-- Error/Retry icon -->
        <svg *ngIf="hasError && !isLoading" width="28" height="28" viewBox="0 0 24 24" fill="white">
          <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Status Bar -->
  <div class="status-bar" [class.playing]="isPlaying" [class.error]="hasError" [class.loading]="isLoading">
    <div class="status-indicator"></div>
    <span *ngIf="!hasError && !isLoading">
      <!-- âœ… Music note icon en vez de ðŸŽµ -->
      <svg *ngIf="isPlaying" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 4px; vertical-align: middle;">
        <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
      </svg>
      <!-- âœ… Pause icon en vez de â¸ï¸ -->
      <svg *ngIf="!isPlaying" width="14" height="14" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 4px; vertical-align: middle;">
        <path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
      </svg>
      {{ isPlaying ? 'Reproduciendo' : 'Pausado' }}
    </span>
    <span *ngIf="isLoading && !hasError">
      <!-- âœ… Loading icon en vez de â³ -->
      <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px; vertical-align: middle; animation: spin 1s linear infinite;">
        <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
      </svg>
      Conectando...
    </span>
    <span *ngIf="hasError">
      <!-- âœ… Warning icon en vez de âš ï¸ -->
      <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 4px; vertical-align: middle;">
        <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
      </svg>
      {{ errorMessage }}
    </span>
  </div>
</div>

<div class="no-station" *ngIf="!station">
  <div class="no-station-content">
    <div class="radio-icon">
      <!-- âœ… Radio icon en vez de ðŸ“» -->
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="2" y="8" width="20" height="14" rx="2"/>
        <circle cx="8" cy="15" r="2"/>
        <path d="M18 12h.01M18 15h.01M2 12h6"/>
        <path d="m7 8 8-5"/>
      </svg>
    </div>
    <p>Selecciona una radio en el mapa</p>
    <button class="random-button-large" (click)="requestRandom()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
      </svg>
      Escuchar radio aleatoria
    </button>
  </div>
</div>
